---
title: "Blocket Car Analysis"
author:
  - Geisol
  - Maria
format: html
---

# Introduction

In this project, we analyze web-scraped used car listings from Blocket, enriched with technical specifications from Transportstyrelsen and cost estimates for insurance and taxation in Sweden. The primary goal has shifted from estimating total yearly ownership cost to two main objectives:
(1) Predicting market prices for used cars in Sweden, with a focus on non-premium, mid-range vehicles, and
(2) Gaining statistical insight into what factors influence insurance premiums and vehicle taxes, using linear regression models.

By combining predictive modeling (e.g., random forest) with inference-driven approaches (e.g., linear regression), we aim to both improve price prediction accuracy and interpret underlying patterns in insurance and tax structures in the Swedish car market.


---


```{r}

library(remotes)
#remotes::install_github("rOpenGov/pxweb", force = TRUE, build_vignettes = FALSE)
library(pxweb)

Sys.setlocale(locale = "UTF-8")

# Step 1: Read your JSON file into a proper query object
px_query <- pxweb_query("scb/trafik.json")

# Step 2: Download the data using the parsed query object
px_data <- pxweb_get(
  url = "https://api.scb.se/OV0104/v1/doris/sv/ssd/TK/TK1001/TK1001S/SnabbStatTK1001",
  query = px_query
)

# Step 3: Convert to data frame
px_data_frame <- as.data.frame(px_data, column.name.type = "text", variable.value.type = "text")


```
```{r}
library(ggplot2)
library(dplyr)

# Om du redan har laddat ner datan till t.ex. `px_data_frame`
# Annars kan du skapa ett exempeldata manuellt så här:
df <- px_data_frame

# Byt gärna till enklare kolumnnamn
colnames(df) <- c("manad", "forandring")

# Om du inte redan gjort detta:
df$datum <- as.Date(paste0(substr(df$manad, 1, 4), "-", substr(df$manad, 6, 7), "-01"))

ggplot(df, aes(x = datum, y = forandring)) +
  geom_point(size = 1.5) +
  geom_smooth(method = "loess", span = 0.2, color = "darkred", se = FALSE, size = 1) +
  theme_minimal() +
  labs(
    title = "Trend för förändring i nyregistrerade bilar",
    x = "Datum",
    y = "Förändring jämfört med året innan (%)"
  )



```

